<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sparkle Clean | Professional Cleaning Services</title>
    <link rel="stylesheet" href="style.css">
    <!-- Google Fonts: Montserrat & Lato -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Montserrat:wght@700&display=swap" rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>

    <header class="main-header">
        <nav class="navbar">
            <a href="#" class="nav-logo" id="logo-text">Sparkle Clean</a>
            <ul class="nav-menu">
                <li class="nav-item"><a href="#about" class="nav-link">About Us</a></li>
                <li class="nav-item"><a href="#services" class="nav-link">Services</a></li>
                <li class="nav-item"><a href="#pricing" class="nav-link">Pricing</a></li>
                <li class="nav-item"><a href="#contact" class="nav-link">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <!-- Hero Section -->
        <!-- The background image will be set by JavaScript -->
        <section class="hero" id="hero-section">
            <div class="hero-content">
                <h1 id="hero-title"></h1>
                <p id="hero-subtitle"></p>
                <a href="#contact" class="cta-button">Get a Free Estimate</a>
            </div>
        </section>

        <!-- About Us Section -->
        <section id="about" class="about-us">
            <div class="container about-us-container">
                <div class="about-us-image">
                    <!-- The image src will be set by JavaScript -->
                    <img src="" alt="Friendly cleaning professional" id="about-image">
                </div>
                <div class="about-us-text">
                    <h2 id="about-title"></h2>
                    <!-- The paragraph content will be set by JavaScript -->
                    <div id="about-description"></div>
                </div>
            </div>
        </section>

        <!-- Services Section -->
        <section id="services" class="services">
            <div class="container">
                <h2 id="services-title"></h2>
                <!-- This grid will be populated by JavaScript -->
                <div class="service-grid" id="service-grid">
                </div>
            </div>
        </section>

        <!-- Pricing Section -->
        <section id="pricing" class="pricing">
            <div class="container">
                <h2 id="pricing-title"></h2>
                <!-- This table will be populated by JavaScript -->
                <div class="pricing-table" id="pricing-table">
                </div>
            </div>
        </section>
        
        <!-- Testimonials Section -->
        <section class="testimonials">
            <div class="container">
                <h2 id="testimonials-title"></h2>
                <!-- This container will be populated by JavaScript -->
                <div class="testimonial" id="testimonial-container">
                </div>
            </div>
        </section>

        <!-- Contact/Booking Form Section -->
        <section id="contact" class="booking-form">
            <div class="container">
                <h2 id="contact-title"></h2>
                <!-- The form action should be set to your Formspree endpoint or other service -->
                <form action="https://formspree.io/f/your_unique_code" method="POST">
                    <input type="text" name="name" placeholder="Your Name" required>
                    <input type="email" name="email" placeholder="Your Email" required>
                    <select name="service" required>
                        <option value="" disabled selected>Select a Service</option>
                        <option value="residential">Residential Cleaning</option>
                        <option value="commercial">Commercial Cleaning</option>
                        <option value="deep-cleaning">Deep Cleaning</option>
                        <option value="move-out">Move-Out Cleaning</option>
                    </select>
                    <textarea name="message" placeholder="Your Message (Optional)" rows="5"></textarea>
                    <button type="submit" class="cta-button">Send Request</button>
                </form>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        <div class="container">
            <p id="footer-text"></p>
        </div>
    </footer>

    <!-- Library to render Markdown content from the CMS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
    
    <!-- Your existing script.js can be used for things like smooth scroll -->
    <script src="script.js"></script>

    <!-- New script to load content from Decap CMS -->
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Fetch the single JSON file containing all homepage content
                const response = await fetch('/_data/homepage.json');
                if (!response.ok) {
                    throw new Error('Could not fetch homepage data.');
                }
                const data = await response.json();
                const converter = new showdown.Converter();

                // --- Populate Hero Section ---
                document.getElementById('hero-section').style.backgroundImage = `linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('${data.hero_image}')`;
                document.getElementById('hero-title').innerText = data.hero_title;
                document.getElementById('hero-subtitle').innerText = data.hero_subtitle;
                document.getElementById('logo-text').innerText = data.logo_text;

                // --- Populate About Section ---
                document.getElementById('about-image').src = data.about_image;
                document.getElementById('about-title').innerText = data.about_title;
                document.getElementById('about-description').innerHTML = converter.makeHtml(data.about_description);

                // --- Populate Services Section ---
                document.getElementById('services-title').innerText = data.services_title;
                const serviceGrid = document.getElementById('service-grid');
                serviceGrid.innerHTML = ''; // Clear existing content
                data.services.forEach(service => {
                    const serviceDiv = document.createElement('div');
                    serviceDiv.className = 'service-item';
                    serviceDiv.innerHTML = `
                        <i class="${service.icon}"></i>
                        <h3>${service.title}</h3>
                        <p>${service.description}</p>
                    `;
                    serviceGrid.appendChild(serviceDiv);
                });

                // --- Populate Pricing Section ---
                document.getElementById('pricing-title').innerText = data.pricing_title;
                const pricingTable = document.getElementById('pricing-table');
                pricingTable.innerHTML = ''; // Clear existing content
                data.pricing_plans.forEach(plan => {
                    const planDiv = document.createElement('div');
                    planDiv.className = `pricing-plan ${plan.is_popular ? 'popular' : ''}`;
                    // Create list items from the features string array
                    const featuresList = plan.features.map(feature => `<li><i class="fas fa-check"></i> ${feature}</li>`).join('');
                    planDiv.innerHTML = `
                        <h3>${plan.title}</h3>
                        <div class="price">${plan.price}</div>
                        <ul>${featuresList}</ul>
                        <a href="#contact" class="cta-button">Choose Plan</a>
                    `;
                    pricingTable.appendChild(planDiv);
                });

                // --- Populate Testimonials Section ---
                document.getElementById('testimonials-title').innerText = data.testimonials_title;
                const testimonialContainer = document.getElementById('testimonial-container');
                testimonialContainer.innerHTML = ''; // Clear existing content
                // For now, we'll show the first testimonial. You could build a slider here.
                if (data.testimonials && data.testimonials.length > 0) {
                    const testimonial = data.testimonials[0];
                    testimonialContainer.innerHTML = `
                        <img src="${testimonial.image}" alt="Client ${testimonial.author}">
                        <blockquote>"${testimonial.quote}"</blockquote>
                        <cite>- ${testimonial.author}</cite>
                    `;
                }

                 // --- Populate Contact Section ---
                document.getElementById('contact-title').innerText = data.contact_title;

                // --- Populate Footer ---
                document.getElementById('footer-text').innerText = data.footer_text;

            } catch (error) {
                console.error('Error loading dynamic content:', error);
            }
        });
    </script>
</body>
</html>